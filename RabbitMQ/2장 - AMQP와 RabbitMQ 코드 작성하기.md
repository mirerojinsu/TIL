## AMQP와 RabbitMQ 코드 작성하기

### 2.1 RPC 전송으로서의 AMQP
- RabbitMQ 는 거의 모든 부분에서 RPC (Remote Procedure Call) 패턴으로 엄격하게 통신한다.
- 웹 API와는 다르게 AMQP 스펙은 서버와 클라이언트 모두 명령을 실행할 수 있다. (양방향)

### 2.1.1 대화 시작하기
클라이언트 -> [프로토콜 헤더] -> RabbitMQ
클라이언트 <- [Connection.Start] <- RabbitMQ
클라이언트 -> [Connection.StartOK] -> RabbitMQ

### 2.1.2 올바른 채널로 튜닝
- 채널은 협상이 완료된 AMQP 연결을 정보 전송을 위한 수도관철머 사용.
- 양방향이 가능하며, 다른 채널로부터 전송을 격리.
- 단일 AMQP 연결에는 여러 채널이 있음 => **멀티플렉싱**

> 각 채널마다 메모리 구조와 객체가 설정돼 있기 때문에 채널이 많을수록 그 연결에 대한 메시지 흐름을 관리하는 데 더 많은 메모리를 사용한다. 따라서 적당한 채널 사용이 중요하다.

```
마샬링이란?

데이터를 한 프로그램이나 시스템에서 다른 프로그램이나 시스템으로 전달 가능하도록 변환하는 작업이다. 
'직렬화'와 거의 같은 의미로 사용된다.
ex) Java 객체 → JSON 문자열로 변환

반대 과정을 언마샬링 또는 '역직렬화' 라고 한다.
```

### 2.2 AMQP의 RPC 프레임 구조
위에서 살펴봤던 Connection.Start 는 [클래스].[메소드] 형식이며, AMQP 스펙에는 많은 명령어들이 있다. 